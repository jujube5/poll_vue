import{u as B,a as f,o as D,c as T,b as M,d as b,e as _,f as s,t as k,g as E,j as N,i as w}from"./index-cef1f5e4.js";const P={class:"poll step3"},C={class:"row block"},F=s("div",{class:"block-title"},[s("h1",null,"Шаг 3")],-1),j={key:0,class:"error row"},q=N('<div class="row poll-row"><h3>Отметьте среди указанных все простые числа:</h3></div><div class="row poll-row"><input type="checkbox" id="step3-2" name="step3" value="2"><label for="step3-2">2</label></div><div class="row poll-row"><input type="checkbox" id="step3-4" name="step3" value="4"><label for="step3-4">4</label></div><div class="row poll-row"><input type="checkbox" id="step3-11" name="step3" value="11"><label for="step3-11">11</label></div><div class="row poll-row"><input type="checkbox" id="step3-8" name="step3" value="8"><label for="step3-8">8</label></div><div class="row poll-row"><input type="checkbox" id="step3-22" name="step3" value="22"><label for="step3-22">22</label></div>',6),R={__name:"step3-view",setup(A){const a=B(),u=f(""),p=f(""),d=f(!1);function g(e,t,o){d.value=e,u.value=t,p.value=o}const S=localStorage.getItem("poll_id"),n=w.get_poll_url+S,c=localStorage.getItem("token"),i=localStorage.getItem("gift");function r(e,t,o,l,m){w.apiPutPollFunc(e,t,o,l,m).then(function(v){v[0]=="error"?g(!0,"Ошибка сети или сервера SIV003",v[1]):v[1].message=="Unauthenticated."&&g(!0,"Ошибка авторизации SIV004","Попробуйте ещё раз")})}function I(e){return new Promise(t=>setTimeout(t,e))}function h(e,t,o,l,m){u.value="Вы заморожены.",p.value="До разморозки осталось минут: "+e+".",d.value=!0,document.getElementById("step3-button").disabled=!0,I(t).then(()=>{r(o,l,"step4","0000-00-00 00:00:00",m),localStorage.setItem("last_step","step4"),localStorage.setItem("time","0000-00-00 00:00:00"),a.push({name:"step4"})})}function y(){const e=document.querySelectorAll('input[name="step3"]:checked');if(e.length==2)if(e[0].value+e[1].value=="211")r(c,n,"step6","0000-00-00 00:00:00","yes"),localStorage.setItem("last_step","step6"),a.push({name:"step6"});else{const o=new Date,l=Date.parse(o);r(c,n,"step3",l,i),localStorage.setItem("time",l),h(10,6e5,c,n,i)}}function x(){if(localStorage.getItem("time")!="0000-00-00 00:00:00"){document.getElementById("step3-button").disabled=!0;const e=new Date,t=localStorage.getItem("time"),o=e-t;if(o<6e5){const l=10-Math.floor(o/6e4);h(l,o,c,n,i)}else r(c,n,"step4","0000-00-00 00:00:00",i),localStorage.setItem("last_step","step4"),localStorage.setItem("time","0000-00-00 00:00:00"),a.push({name:"step4"})}}function V(){localStorage.clear(),a.push({name:"sign-in"})}return D(()=>{T.checkToken(a)}),M(()=>{x()}),(e,t)=>(b(),_("div",P,[s("div",C,[F,d.value?(b(),_("div",j,[s("p",null,k(u.value),1),s("p",null,k(p.value),1)])):E("",!0),q,s("div",{class:"row"},[s("button",{id:"step3-button",onClick:y},"Ответить")]),s("div",{class:"row"},[s("button",{id:"sign-out-button",onClick:V},"Выйти")])])]))}};export{R as default};
