import{u as M,a as s,o as N,c as T,b as L,d as u,e as i,f as e,t as l,g as w,i as b}from"./index-cef1f5e4.js";const P={class:"poll step2"},R={class:"row block"},z=e("div",{class:"block-title"},[e("h1",null,"Шаг 2")],-1),D={key:0,class:"error row"},F={key:1,class:"error row"},O=e("div",{class:"row poll-row"},[e("h3",null,"Как называется косметический бренд компании Shiawasedo?")],-1),U=e("div",{class:"row"},[e("input",{type:"text",placeholder:"Введите ответ",id:"step2-input"})],-1),A={__name:"step2-view",setup(j){const a=M(),p=s(""),m=s(""),g=s(!1);function _(t,r,o){g.value=t,p.value=r,m.value=o}const d=s(""),f=s(""),v=s(!1);function C(){v.value=!0,d.value=localStorage.getItem("error_name"),f.value=localStorage.getItem("error_message")}const V=localStorage.getItem("poll_id"),h=b.get_poll_url+V,S=localStorage.getItem("token"),I=localStorage.getItem("gift");function k(t,r,o,n,x){b.apiPutPollFunc(t,r,o,n,x).then(function(c){c[0]=="error"?_(!0,"Ошибка сети или сервера SIV003",c[1]):c[1].message=="Unauthenticated."&&_(!0,"Ошибка авторизации SIV004","Попробуйте ещё раз")})}function y(){const t=document.getElementById("step2-input").value,o=t.toLowerCase().replace("summus","");if(o.length>0){const n=/[a-z0-9]/gi;return!o.match(n)}else return t.length!=0}function B(){localStorage.removeItem("error_name"),localStorage.removeItem("error_message"),y()===!0?(k(S,h,"step3","0000-00-00 00:00:00",I),localStorage.setItem("last_step","step3"),a.push({name:"step3"})):(k(S,h,"step1","0000-00-00 00:00:00",I),localStorage.setItem("last_step","step1"),localStorage.setItem("error_name","Ответ на шаге 2 был неверный."),localStorage.setItem("error_message","Поэтому вернулись на шаг 1"),a.push({name:"step1"}))}function E(){localStorage.clear(),a.push({name:"sign-in"})}return N(()=>{T.checkToken(a)}),L(()=>{localStorage.getItem("error_name")!==null&&C()}),(t,r)=>(u(),i("div",P,[e("div",R,[z,g.value?(u(),i("div",D,[e("p",null,l(p.value),1),e("p",null,l(m.value),1)])):w("",!0),v.value?(u(),i("div",F,[e("p",null,l(d.value),1),e("p",null,l(f.value),1)])):w("",!0),O,U,e("div",{class:"row"},[e("button",{id:"step2-button",onClick:B},"Ответить")]),e("div",{class:"row"},[e("button",{id:"sign-out-button",onClick:E},"Выйти")])])]))}};export{A as default};
